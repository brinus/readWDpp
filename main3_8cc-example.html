<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>readWDpp: main3.cc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">readWDpp
   </div>
   <div id="projectbrief">Read binary files from DRS and WDB</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">main3.cc</div></div>
</div><!--header-->
<div class="contents">
<p>The WDB has at the inside two different DRS chips, due to this fact the difference between two same timecells depends on what channel are we looking at. In particular the channels going from 0 to 7 (included) are on the same first chip, the channels going from 8 to 15 are on the same second chip.</p>
<p>To show this effect a NIM signal is generated and splitted equally to be then distributed to two channels of the WDB. The file <code>data/split1-2at4GSPS</code> contains the waveform on channel 0 and channel 1, the file <code>data/split1-8at4GSPS</code> contains the waveform on the channel 0 and channel 8.</p>
<p>This script uses the methods <a class="el" href="classDAQEvent.html#ab1176184ce5206715972cb5fb965a8b9">DAQEvent::GetChannel</a> and <a class="el" href="classDAQEvent.html#a1300b318afa84d0c4a49c0ec63e5e56d">DAQEvent::GetTimes()</a> to get the times array of the selected channels at every event reading. Using a simple for loop we get each cell difference and we then fill an histogram.</p>
<p>The results show that there is an order of magnitude in temporal resolution between channels on the same chip (red dotted line, <em>std.dev.</em> \(\sim 10^{-12}\textup{s}\)) and channel on different chips (blue solid line, <em>std.dev.</em> \(\sim 10^{-11}\textup{s}\)). This effect can anyway be corrected using the information contained on channels 16 and 17.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;../readWD.hh&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;TApplication.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;TLegend.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;TCanvas.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;TH1F.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> main1()</div>
<div class="line">{</div>
<div class="line">    <a id="_a0" name="_a0"></a><a class="code hl_class" href="classDAQFile.html">DAQFile</a> file;</div>
<div class="line">    <a id="_a1" name="_a1"></a><a class="code hl_class" href="classWDBEvent.html">WDBEvent</a> event;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> c0 = <span class="keyword">new</span> TCanvas(<span class="stringliteral">&quot;c0&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>, 1);</div>
<div class="line">    <span class="keyword">auto</span> h0 = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;ch01&quot;</span>, <span class="stringliteral">&quot;ch01&quot;</span>, 80, -0.07e-9, 0.07e-9);</div>
<div class="line">    <span class="keyword">auto</span> h1 = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;ch08&quot;</span>, <span class="stringliteral">&quot;ch08&quot;</span>, 80, -0.7e-9, 0.7e-9);</div>
<div class="line">    <span class="keyword">auto</span> legend = <span class="keyword">new</span> TLegend();</div>
<div class="line"> </div>
<div class="line">    file.<a id="a2" name="a2"></a><a class="code hl_function" href="classDAQFile.html#a825bff86707cd65dcf2e625c25d85f96">Open</a>(<span class="stringliteral">&quot;data/split1-2at4GSPS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (file &gt;&gt; event)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">auto</span> &amp;times0 = <span class="keyword">event</span>.GetChannel(0, 0).GetTimes();</div>
<div class="line">        <span class="keyword">auto</span> &amp;times1 = <span class="keyword">event</span>.GetChannel(0, 1).GetTimes();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a id="a3" name="a3"></a><a class="code hl_define" href="readWD_8hh.html#a0606d74796559e9e9b17d890a305d35a">SAMPLES_PER_WAVEFORM</a>; ++j)</div>
<div class="line">        {</div>
<div class="line">            h0-&gt;Fill(times0[j] - times1[j]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    file.<a id="a4" name="a4"></a><a class="code hl_function" href="classDAQFile.html#a8c817a643655e94d41b1cc7487a61d8d">Close</a>();</div>
<div class="line">    file.<a class="code hl_function" href="classDAQFile.html#a825bff86707cd65dcf2e625c25d85f96">Open</a>(<span class="stringliteral">&quot;data/split1-8at4GSPS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (file &gt;&gt; event)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">auto</span> &amp;times0 = <span class="keyword">event</span>.GetChannel(0, 0).GetTimes();</div>
<div class="line">        <span class="keyword">auto</span> &amp;times8 = <span class="keyword">event</span>.GetChannel(0, 8).GetTimes();</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="readWD_8hh.html#a0606d74796559e9e9b17d890a305d35a">SAMPLES_PER_WAVEFORM</a>; ++j)</div>
<div class="line">        {</div>
<div class="line">            h1-&gt;Fill(times0[j] - times8[j]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    h1-&gt;SetTitle(<span class="stringliteral">&quot;Time resolution on same chip and on different chips&quot;</span>);</div>
<div class="line">    h1-&gt;SetLineColor(4);</div>
<div class="line"> </div>
<div class="line">    h0-&gt;SetLineColor(2);</div>
<div class="line">    h0-&gt;SetLineStyle(2);</div>
<div class="line"> </div>
<div class="line">    h1-&gt;Draw();</div>
<div class="line">    h0-&gt;Draw(<span class="stringliteral">&quot;SAMES&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    h1-&gt;GetYaxis()-&gt;SetRangeUser(0, 5.5e4);</div>
<div class="line">    h1-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Time [s]&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    legend-&gt;AddEntry(h0, <span class="stringliteral">&quot;same chip&quot;</span>);</div>
<div class="line">    legend-&gt;AddEntry(h1, <span class="stringliteral">&quot;different chip&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    legend-&gt;Draw();</div>
<div class="line">    c0-&gt;Update();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    TApplication app(<span class="stringliteral">&quot;ROOT Application&quot;</span>, &amp;argc, argv);</div>
<div class="line">    main1();</div>
<div class="line">    app.Run();</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassDAQFile_html"><div class="ttname"><a href="classDAQFile.html">DAQFile</a></div><div class="ttdoc">Class to manage the file and the outputing of data in a DAQEvent instance.</div><div class="ttdef"><b>Definition:</b> <a href="readWD_8hh_source.html#l00202">readWD.hh:203</a></div></div>
<div class="ttc" id="aclassDAQFile_html_a825bff86707cd65dcf2e625c25d85f96"><div class="ttname"><a href="classDAQFile.html#a825bff86707cd65dcf2e625c25d85f96">DAQFile::Open</a></div><div class="ttdeci">DAQFile &amp; Open(const std::string &amp;)</div><div class="ttdoc">Method to open a file given the file path and name.</div><div class="ttdef"><b>Definition:</b> <a href="readWD_8cc_source.html#l01067">readWD.cc:1067</a></div></div>
<div class="ttc" id="aclassDAQFile_html_a8c817a643655e94d41b1cc7487a61d8d"><div class="ttname"><a href="classDAQFile.html#a8c817a643655e94d41b1cc7487a61d8d">DAQFile::Close</a></div><div class="ttdeci">DAQFile &amp; Close()</div><div class="ttdoc">Method to close the file.</div><div class="ttdef"><b>Definition:</b> <a href="readWD_8cc_source.html#l01047">readWD.cc:1047</a></div></div>
<div class="ttc" id="aclassWDBEvent_html"><div class="ttname"><a href="classWDBEvent.html">WDBEvent</a></div><div class="ttdoc">Specialization of DAQEvent to a WaveDREAM board.</div><div class="ttdef"><b>Definition:</b> <a href="readWD_8hh_source.html#l00194">readWD.hh:195</a></div></div>
<div class="ttc" id="areadWD_8hh_html_a0606d74796559e9e9b17d890a305d35a"><div class="ttname"><a href="readWD_8hh.html#a0606d74796559e9e9b17d890a305d35a">SAMPLES_PER_WAVEFORM</a></div><div class="ttdeci">#define SAMPLES_PER_WAVEFORM</div><div class="ttdoc">The number of samples made by the waveforms, both DRS and WDB.</div><div class="ttdef"><b>Definition:</b> <a href="readWD_8hh_source.html#l00025">readWD.hh:25</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
